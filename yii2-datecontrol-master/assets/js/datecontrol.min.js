/*!
 * @copyright Copyright &copy; Kartik Visweswaran, Krajee.com, 2014
 * @version 1.7.0
 *
 * Date control validation plugin
 * 
 * Author: Kartik Visweswaran
 * Copyright: 2014, Kartik Visweswaran, Krajee.com
 * For more JQuery plugins visit http://plugins.krajee.com
 * For more Yii related demos visit http://demos.krajee.com
 */!function(e){var t=function(t,a){return null===t||void 0===t||t==[]||""===t||a&&""===e.trim(t)},a=function(t,a){this.$element=e(t),this.init(a),this.listen()};a.prototype={constructor:a,init:function(a){var n=this,r=t(a.dateSettings)?{}:{dateSettings:a.dateSettings};n.$idSave=e("#"+a.idSave),n.url=a.url,n.reqType=a.type,n.dispFormat=a.dispFormat,n.saveFormat=a.saveFormat,n.dispTimezone=a.dispTimezone,n.saveTimezone=a.saveTimezone,n.asyncRequest=a.asyncRequest,n.dateFormatter=new DateFormatter(r)},listen:function(){var a=this,n=a.$element,r=a.$idSave,s=a.url,i=a.reqType,o=a.dispFormat,u=a.saveFormat,d=a.dispTimezone,c=a.saveTimezone,l=a.asyncRequest,p=a.dateFormatter;n.on("change",function(){if(t(n.val()))r.val("");else if(t(s)){var a=p.parseDate(n.val(),o);0==a&&(a=p.guessDate(n.val(),o),n.val(p.formatDate(a,o))),r.val(p.formatDate(a,u))}else e.ajax({url:s,type:"post",dataType:"json",async:l,data:{displayDate:n.val(),type:i,dispFormat:o,saveFormat:u,dispTimezone:d,saveTimezone:c},success:function(e){"success"==e.status&&r.val(e.output)}});r.trigger("change")}),n.on("keydown",function(a){if(t(n.val()))n.val("");else{switch(a.keyCode){case 27:e.isFunction(n.parent().datepicker)&&(n.parent().datepicker("hide"),a.preventDefault),e.isFunction(n.datepicker)&&(n.datepicker("hide"),a.preventDefault);break;case 38:a.preventDefault();var s=p.parseDate(n.val(),o);0!=s&&s.setDate(s.getDate()+1);break;case 40:a.preventDefault();var s=p.parseDate(n.val(),o);0!=s&&s.setDate(s.getDate()-1)}(38==a.keyCode||40==a.keyCode)&&(s=p.formatDate(s,o),n.val(s),n.trigger("change"),e.isFunction(n.parent().datepicker)&&n.parent().datepicker("update"),e.isFunction(n.datepicker)&&n.datepicker("update"))}r.trigger("keydown")})}},e.fn.datecontrol=function(t){var n=Array.apply(null,arguments);return n.shift(),this.each(function(){var r=e(this),s=r.data("datecontrol"),i="object"==typeof t&&t;s||r.data("datecontrol",s=new a(this,e.extend({},e.fn.datecontrol.defaults,i,e(this).data()))),"string"==typeof t&&s[t].apply(s,n)})},e.fn.datecontrol.defaults={dateSettings:{longDays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],longMonths:["January","February","March","April","May","June","July","August","September","October","November","December"],meridiem:["AM","PM"]},dispTimezone:null,saveTimezone:null,asyncRequest:!0}}(jQuery);